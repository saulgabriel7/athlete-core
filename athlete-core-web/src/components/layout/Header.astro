---
/**
 * ATHLETE CORE - Header Component
 */

import { SignedIn, SignedOut, UserButton } from '@clerk/astro/components';

interface Props {
  title?: string;
}

const { title } = Astro.props;
---

<header class="header">
  <div class="header-left">
    <button class="menu-toggle" id="menu-toggle" aria-label="Abrir menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg>
    </button>
    {title && <h1 class="header-title">{title}</h1>}
  </div>
  
  <div class="header-right">
    <SignedIn>
      <UserButton 
        afterSignOutUrl="/"
        appearance={{
          elements: {
            avatarBox: "avatar",
            userButtonTrigger: "user-button-trigger"
          }
        }}
      />
    </SignedIn>
    <SignedOut>
      <a href="/sign-in" class="btn-login">Entrar</a>
    </SignedOut>
  </div>
</header>

<style>
  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: var(--header-height);
    padding: 0 var(--spacing-lg);
    border-bottom: 1px solid var(--color-border);
    background: var(--color-background);
    position: sticky;
    top: 0;
    z-index: 30;
  }

  .header-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
  }

  .menu-toggle {
    display: none; /* Desktop */
    background: none;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    padding: 6px;
    cursor: pointer;
    color: var(--color-foreground);
    transition: background var(--transition-fast);
  }

  .menu-toggle:hover {
    background: var(--color-background-subtle);
  }

  .header-title {
    font-size: var(--font-size-base);
    font-weight: 600;
    margin: 0;
    letter-spacing: -0.01em;
  }

  .header-right {
    display: flex;
    align-items: center;
  }

  .btn-login {
    font-size: var(--font-size-sm);
    font-weight: 500;
    color: var(--color-foreground);
    text-decoration: none;
    padding: 0.5rem 1rem;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    transition: all var(--transition-fast);
  }

  .btn-login:hover {
    background: var(--color-background-subtle);
  }

  :global(.user-button-trigger) {
    border: 1px solid var(--color-border) !important;
    padding: 2px !important;
  }
  
  :global(.avatar) {
    width: 28px !important;
    height: 28px !important;
  }

  @media (max-width: 768px) {
    .menu-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .header {
      padding: 0 var(--spacing-md);
    }
  }
</style>

<script>
  const toggle = document.getElementById('menu-toggle');
  toggle?.addEventListener('click', () => {
    window.dispatchEvent(new CustomEvent('open-sidebar'));
  });
</script>
