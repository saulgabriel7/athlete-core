---
/**
 * ATHLETE CORE - Header Component
 * Cabe√ßalho do dashboard com design premium
 */

import { SignedIn, SignedOut, UserButton } from '@clerk/astro/components';

interface Props {
  title?: string;
}

const { title } = Astro.props;
---

<header class="header">
  <div class="header-left">
    <button class="menu-toggle" id="menu-toggle" aria-label="Abrir menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="3" x2="21" y1="6" y2="6"/>
        <line x1="3" x2="21" y1="12" y2="12"/>
        <line x1="3" x2="21" y1="18" y2="18"/>
      </svg>
    </button>
    {title && (
      <div class="header-title-container">
        <h1 class="header-title">{title}</h1>
      </div>
    )}
  </div>
  
  <div class="header-right">
    <SignedIn>
      <UserButton 
        afterSignOutUrl="/"
        appearance={{
          elements: {
            avatarBox: "user-avatar",
            userButtonTrigger: "user-button-trigger",
            userButtonPopoverCard: "user-popover"
          },
          variables: {
            colorPrimary: "#c4ff3b",
            colorBackground: "#18181b",
            colorText: "#fafafa",
            colorTextSecondary: "#a1a1aa",
            colorInputBackground: "#121214",
            borderRadius: "8px"
          }
        }}
      />
    </SignedIn>
    <SignedOut>
      <a href="/sign-in" class="btn-login">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
          <polyline points="10 17 15 12 10 7"/>
          <line x1="15" x2="3" y1="12" y2="12"/>
        </svg>
        Entrar
      </a>
    </SignedOut>
  </div>
</header>

<style>
  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: var(--header-height);
    padding: 0 var(--spacing-xl);
    background: rgba(10, 10, 11, 0.8);
    backdrop-filter: var(--glass-blur);
    -webkit-backdrop-filter: var(--glass-blur);
    border-bottom: 1px solid var(--color-border);
    position: sticky;
    top: 0;
    z-index: var(--z-header);
  }

  .header-left {
    display: flex;
    align-items: center;
    gap: var(--spacing-lg);
  }

  .menu-toggle {
    display: none;
    background: var(--color-background-elevated);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-sm);
    cursor: pointer;
    color: var(--color-foreground);
    transition: all var(--transition-fast);
  }

  .menu-toggle:hover {
    background: var(--color-accent-muted);
    border-color: var(--color-accent);
    color: var(--color-accent);
  }

  .header-title-container {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
  }

  .header-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    margin: 0;
    letter-spacing: var(--letter-spacing-tight);
    color: var(--color-foreground);
  }

  .header-right {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
  }

  .btn-login {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-foreground);
    text-decoration: none;
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--color-background-elevated);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    transition: all var(--transition-fast);
  }

  .btn-login:hover {
    background: var(--color-accent);
    color: var(--color-black);
    border-color: var(--color-accent);
  }

  /* Clerk UserButton Styles */
  :global(.user-button-trigger) {
    border: 2px solid var(--color-border) !important;
    border-radius: var(--radius-full) !important;
    padding: 2px !important;
    transition: all var(--transition-fast) !important;
  }

  :global(.user-button-trigger:hover) {
    border-color: var(--color-accent) !important;
    box-shadow: 0 0 12px var(--color-accent-glow) !important;
  }
  
  :global(.user-avatar) {
    width: 32px !important;
    height: 32px !important;
  }

  :global(.user-popover) {
    background: var(--color-background-elevated) !important;
    border: 1px solid var(--color-border) !important;
    border-radius: var(--radius-lg) !important;
  }

  @media (max-width: 768px) {
    .menu-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .header {
      padding: 0 var(--spacing-md);
    }

    .header-title {
      font-size: var(--font-size-base);
    }
  }
</style>

<script>
  const toggle = document.getElementById('menu-toggle');
  toggle?.addEventListener('click', () => {
    window.dispatchEvent(new CustomEvent('open-sidebar'));
  });
</script>
